tests:
  - input:
      rate: 2
      map: |
        ...#......
        .......#..
        #.........
        ..........
        ......#...
        .#........
        .........#
        ..........
        .......#..
        #...#.....
    output: 374
  - input:
      rate: 10
      map: |
        ...#......
        .......#..
        #.........
        ..........
        ......#...
        .#........
        .........#
        ..........
        .......#..
        #...#.....
    output: 1030
puzzle:
  input:
    rate: 1000000
    map: |
      ..........#............................................#..........#.....#...........................................#.......#.........#.....
      .....#...................#..............#....................................................#..............................................
      ..............................#....................#...................................................#....................................
      .............................................#.....................................................................................#........
      ............#................................................................#......#.......................................................
      ......................................#..................#.........................................#........................................
      .............................................................................................................................#..............
      .................#.....#....................................................................................................................
      .....................................................#...........#..........................................#.............................#.
      .....#..........................#...............#.......................................#...........................#.......................
      ....................#................#...............................#.........................#.....#......................................
      ...........#.............................................#..................................................................................
      ................................................................................................................................#.....#.....
      ................#...................................#...........#......................................................#....................
      .........................#.................................................#.................................#.............................#
      ...#..............................#...................................#................................#....................................
      ...............................................................................#............................................................
      ..................................................................#...........................#..........................#........#.........
      .........#....................#........................................................................................................#....
      ..........................................................................#..............#........................#.........................
      ....................#...............................#........#..............................................................................
      ..#..............................#........#...................................#..........................#..................#...............
      ......................................................................#...........................#............#...................#........
      ........#................#..............................#.............................................................#.................#...
      ......................................#......#....................#........#.....#.........#................................................
      .....................#............................#.............................................................................#...........
      ....#.........................#.............................................................................#...............................
      ............#..................................................#................................#...........................#...............
      ....................................................................................#..................#.............#......................
      ..........................................................................................................................................#.
      ...................................#...............#.....................................#.......................#..........................
      ..#................#.......................#................................................................................................
      ...........#...............#...........................................#.................................................#.........#........
      ......#.....................................................................#............................#..................................
      .........................................................#..................................................................................
      ...................................................................#........................................................................
      .........#....................................................#......................................#............#....................#....
      ...................................................#....................#...........#......................#...............#................
      ..#..............................#......#........................................................#..........................................
      ........................................................#...........................................................................#.......
      ......................................................................................................................#.....................
      ......#......................................................................#................#.............................................
      ............................................#..............#............................................#...................#...............
      .......................#........#......#........................#..................................................#........................
      ....................................................#......................................#.......#.........#..............................
      ........#..........................................................................................................................#........
      ................#...........................................................................................................................
      #..........................#.......#......#.............................#.................................#.................................
      ......................................................#.............................#............#.......................#.....#............
      ...................#.............................................#...........#...........#..............................................#...
      ...............................#..................#..........................................................#..............................
      ..............#..............................................#.......................................#......................................
      ..#.....................#.............#........................................................#............................................
      ...................................................................#........................................................................
      ............................................................................................................................................
      ........#.......#.....................................................................#.....................................................
      ...............................#.....................#..................#.....................................#.........#...................
      ..............................................#...............................#............#........#.......................................
      .#.................#........................................................................................................................
      ..................................#................................................#.....................................................#..
      ............................................................................................................................................
      ...........#..................#....................#....................................#...................................................
      ....#....................................#.........................#.....#......................#...............#..............#............
      .................................................................................#..........................................................
      ...............................................#........................................................#...........#.....................#.
      ........................#........#.........................#................................................................................
      ....................................................................................#..............................................#........
      ...#......................................#.................................................................................................
      .....................................................#.........................................#......#.........#...........................
      ..............................#..........................................................#.................#................#...............
      ..............#....................................................#......#.................................................................
      ........#............#..........................................................................................................#...........
      ............................................................................................................................................
      ...........................#.....................#..............#..................................#................................#.......
      ............................................................................#...............................................................
      .............................................#..........................................................#.................................#.
      .....................................................#..............#.......................................................................
      ......#................#................#..................#.................................................#...........#..................
      ................#.................#......................................#........................................#...........#.............
      ...........#....................................#................#..........................#......................................#........
      ............................................................................................................................................
      ...................#..................................#.....................................................................................
      ...#.......................#..............#.................#..............#..........#...................................................#.
      ......................................................................................................#................#.............#......
      ....................................................................#............................#..............................#...........
      ...............................#..................#.......................................#...............#................#................
      ............................................................................................................................................
      ............................................................................................................................................
      ......................#...............................#..........#.............................................#...................#........
      ........................................#..............................................................#.................#..................
      ..........................#........#.......................................#..........#....................................................#
      ..................#...........................#.............................................................................................
      ......#....................................................#...............................#................................................
      ..............................#.............................................................................................................
      ................................................................................................#........#..................................
      #.............#.......................................................#........#...............................................#.......#....
      ...........................#...................................................................................#............................
      ....#...................................#...................................................................................................
      ................................................#......#..................................................................................#.
      .......................................................................................#.............#......................................
      ................................#..........................#..................#...........................#.................................
      ....................#...........................................................................................#...................#.......
      ...................................................#..............#.......#............................................#....................
      ..#.........................................................................................................................................
      ........#.....#.......................#.......#..............................................................................#..............
      ......................#.......#.........................#........................#...........#.......#...................................#..
      ...............................................................................................................#............................
      .......................................................................................#..................#.................................
      ........................................................................#.........................#..................#......................
      ..........................................#.....#.........................................................................#.................
      ..................#..........#...............................#..............................................................................
      ......................................#........................................#.........#..................................................
      ...#...............................................................................................................#....................#...
      ........#..............................................#...............#.....................................................#..............
      ...................................#........................................#...............#............#..........................#.......
      ............#.................#.............................................................................................................
      ....................#.............................#.........................................................................................
      ....................................................................................#..............#........................................
      ...............#......................................#.......................................#.........................................#...
      .#........................#........................................#...............................................#......#.................
      ........................................#.................................................#.................................................
      .....#...................................................................#..................................................................
      ..................................................................................................#............#............................
      ............#.......#.........#.....#...............#.......#...........................................#...................................
      ..#..........................................#......................#..................#...............................................#....
      ............................................................................................................................................
      .........................#.............#....................................................................................................
      ..................................................#............................#................................#...................#.......
      ...................................#..............................................................#......#..................................
      ............................................................................................................................................
      ........................................................#.....#............................#..........................#.....#...............
      ......................#.......................#..........................#.............................................................#....
      ......#.....#.........................................................................................#.....................................
      ..................................................................#...............................................................#.........
      ...................................#.........................................#.................#..........................#...............#.
      ..#.........................................#.........................#..............#......................................................
      ...................................................#......................................#...................#.............................
      .........................................................#..................................................................................
      ..............#................................................#..................................#.........................................
      ...................#..........#..........#................................................................#......#............#............#
